{% extends 'base.html' %}

{% block title %}My Tasks{% endblock %}

{% block content%}

	<header class="row">
		<div class="col-lg-6 col-sm-7">
			<h1>My Tasks</h1>
		</div>
	</header>
	
	{% if perms.api.add_task %}
		<a class="btn btn-default" href="{% url 'task-new' %}"><span class="glyphicon glyphicon-plus"> Add new task</span></a>
	{% endif %}	

	{% if task_list %}
		<div class="row">
			{% for task in task_list %}	
				
					<div class="col-md-3 col-xs-6">
						<h1><strong>{{ task.title }}</strong></h1>
						{% if perms.api.change_task %}
							<a class="btn btn-default" href="{% url 'task-edit' task_id=task.id %}"><span class="glyphicon glyphicon-pencil"> Edit</span></a>
						{% endif %}
						{% if perms.api.delete_task %}
							<a class="btn btn-default" href="{% url 'task-delete' task_id=task.id %}"><span class="glyphicon glyphicon-remove"> Delete</span></a>
						{% endif %}
						<p><strong>Assigned to:</strong> {{ task.assigned_id }}</p>
						<p><strong>Project status:</strong> {{ task.get_status_display }} </p>
						<p><strong>Part of project:</strong> <a href="{% url 'web.views.project_detail' project_id=task.project_id.project_id %}"> {{ task.project_id.project_name }}</a></p>
						<br />
						<p><strong>Description:</strong> {{ task.description }}</p>
						<p class="deadline"><strong>Deadline:</strong>
							{% if task.deadline %}
								{{ task.deadline|date:"d. M Y"|lower }}
							{% else %}
								none
							{% endif %}
						</p>
					</div>
					{% if forloop.last %}
						  </div>
					{% else %}
						{% if forloop.counter|divisibleby:"4" %}
			  				</div>
							<div class="row">
						{% endif %}
			  		{% endif %}
			  
				
			{% endfor %}
			  
		{% if not user.is_authenticated %}
			<div class="row">
				<p><a href="{% url 'pages-login' %}">Login </a>to edit tasks.</strong></p>
			</div>
		{% endif %}
			  
	{% else %}
		<br></br>
		<div class="col-lg-6 col-sm-7 alert alert-info">
			<p>There are currently no tasks in the tasks list.</p>
		</div>

	{% endif %}

{% endblock content%}
